---
import { readdir } from "node:fs/promises";
import { join } from "node:path";
import matter from "gray-matter";

const toolsDir = join(process.cwd(), "content", "tools");
const files = (await readdir(toolsDir))
  .filter((f) => f.endsWith(".md") && !f.startsWith("_"));

const tools = await Promise.all(
  files.map(async (file) => {
    const full = join(toolsDir, file);
    const raw = await (await import("node:fs/promises")).readFile(full, "utf-8");
    const { data } = matter(raw);
    const slug = String(data.slug ?? file.replace(/\.md$/, ""));
    const title = String(data.title ?? slug);
    return { slug, title };
  })
);

tools.sort((a, b) => a.title.localeCompare(b.title, "de"));
---

<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Tools</title>
  </head>
  <body>
    <main style="max-width: 960px; margin: 40px auto; padding: 0 16px;">
      <h1>Tools</h1>
      <ul>
        {tools.map((t) => (
          <li><a href={`/tools/${t.slug}/`}>{t.title}</a></li>
        ))}
      </ul>
    </main>
  </body>
</html>
