---
import { readdir } from "node:fs/promises";
import { join } from "node:path";
import matter from "gray-matter";

const toolsDir = join(process.cwd(), "content", "tools");
const files = (await readdir(toolsDir))
  .filter((f) => f.endsWith(".md") && !f.startsWith("_"));

const tools = await Promise.all(
  files.map(async (file) => {
    const full = join(toolsDir, file);
    const raw = await (await import("node:fs/promises")).readFile(full, "utf-8");
    const { data } = matter(raw);
    const slug = String(data.slug ?? file.replace(/\.md$/, ""));
    const title = String(data.title ?? slug);
    return { slug, title };
  })
);

tools.sort((a, b) => a.title.localeCompare(b.title, "de"));
---

<html lang="de">
  <head>
    <link rel="stylesheet" href="/styles/global.css" />
<meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Tools</title>
</head>
  <body>
    <main>
      <div class="header">
        <div>
          <div class="badge">Utildesk · Tool Directory</div>
          <h1 class="h1">Tools</h1>
          <p class="lead">Kuratiertes Verzeichnis nützlicher AI- und Produktivitätstools.</p>
        </div>
      </div>

      <ul class="tools-list">
        {tools.map((t) => (
          <li class="card">
            <a class="tool-item" href={"/tools/" + t.slug + "/"}>
              <div class="tool-thumb" aria-hidden="true"></div>
              <div>
                <p class="tool-title">{t.title}</p>
                <p class="tool-meta">/tools/{t.slug}</p>
              </div>
            </a>
          </li>
        ))}
      </ul>
    </main>
  </body>
</html>
